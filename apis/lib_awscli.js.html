<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>lib/awscli.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading">Classes</li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="DynamoDbDeleteItemStatement.html">DynamoDbDeleteItemStatement</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DynamoDbDeleteItemStatement.html#getParameter">getParameter</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DynamoDbDeleteItemStatement.html#run">run</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="DynamoDbPutItemStatement.html">DynamoDbPutItemStatement</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DynamoDbPutItemStatement.html#getParameter">getParameter</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DynamoDbPutItemStatement.html#run">run</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DynamoDbPutItemStatement.html#setValues">setValues</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="DynamoDbQueryStatement.html">DynamoDbQueryStatement</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DynamoDbQueryStatement.html#getParameter">getParameter</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DynamoDbQueryStatement.html#next">next</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DynamoDbQueryStatement.html#parse">parse</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DynamoDbQueryStatement.html#reset">reset</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DynamoDbQueryStatement.html#run">run</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DynamoDbQueryStatement.html#setFilterExpression">setFilterExpression</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DynamoDbQueryStatement.html#setKeyConditionExpression">setKeyConditionExpression</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="DynamoDbReadItemStatement.html">DynamoDbReadItemStatement</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DynamoDbReadItemStatement.html#setExclusiveStartKey">setExclusiveStartKey</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DynamoDbReadItemStatement.html#setLimit">setLimit</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DynamoDbReadItemStatement.html#setProjectionExpression">setProjectionExpression</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="DynamoDbResultSet.html">DynamoDbResultSet</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DynamoDbResultSet.html#.printScanResult">printScanResult</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DynamoDbResultSet.html#getItemAt">getItemAt</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DynamoDbResultSet.html#getItems">getItems</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DynamoDbResultSet.html#print">print</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="DynamoDbScanStatement.html">DynamoDbScanStatement</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DynamoDbScanStatement.html#getParameter">getParameter</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DynamoDbScanStatement.html#next">next</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DynamoDbScanStatement.html#parse">parse</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DynamoDbScanStatement.html#reset">reset</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DynamoDbScanStatement.html#run">run</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="DynamoDbScanStatement.html#setFilterExpression">setFilterExpression</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Statement.html">Statement</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Statement.html#.assertAllParamSpecified">assertAllParamSpecified</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Statement.html#.setParam">setParam</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Statement.html#getParameter">getParameter</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Statement.html#parseConditionExpression">parseConditionExpression</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Statement.html#run">run</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Statement.html#setTableName">setTableName</a></span></li><li class="nav-heading"><a href="global.html">Globals</a></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#convertDescToCreateParam">convertDescToCreateParam</a></span></li>
</nav>

<div id="main">
    
    <h1 class="page-title">lib/awscli.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>"use strict";
var camelcase = require("camelcase");
var awscli = {};

awscli.exec = function(serviceName, command, opts, callback) {
    var service = awscli.getService(serviceName);
    var methodName = camelcase(command);
    var camelOpts = {};
    if(opts) {
        Object.keys(opts).forEach(function(key) {
            if(key.match(/^--/)) {
                camelOpts[camelcase(key.replace(/^--/,""))] = opts[key];
            } else {
                camelOpts[key] = opts[key];
            }
        });
    }
    try {
        service[methodName].apply(service, [camelOpts, callback]);
    } catch(err) {
        console.log(serviceName);
        console.log(command);
        console.error(err.stack);
        Object.keys(service.prototype).forEach(function(methodName) {
            console.log("* " + methodName);
        });
    }
};

(function() {

    var AWS = require("aws-sdk");

    awscli.connect = function(config) {
        config = config || {};
        if(!("region" in config)) {
            //
            // Get default region from the file ~/.aws/config
            //
            var aws_configure = require("./aws-configure");
            var region = aws_configure.getConfiguredRegion(aws_configure.getAwsProfile());
            if(region) {
                config.region = region;
                //AWS.config.update({ "region" : region });
            } else {
                console.error("Error: No AWS region name is determined");
                console.error("Set default region using an AWS CLI command `aws configure`.");
                process.exit(1);
            }
        }
        AWS.config.update(config);
    }

    //
    // Get AWS service class instance
    //
    awscli.getService = function (serviceName) {
        if(!(serviceName in AWS)) {
            console.error("ERROR: Invalid AWS service name", serviceName);
            process.exit(1);
        }
        var service = new AWS[serviceName]();
        if(!service) {
            console.error("ERROR: Fail to create AWS service", serviceName);
            process.exit(1);
        }
        return service;
    };

    var callbackError = function(message, callback) {
        if(callback) {
            callback.call(null, message, null);
        }
    };

    awscli.registerAPIs = function(service_name, service_def) {
        var service = {};
        service.connect = awscli.connect;
        Object.keys(service_def.commands).forEach(function(command_name) {
            var function_name = camelcase(command_name);
            service[function_name] = (function(command_options) { return function() {
                var args = Array.apply(null, arguments);
                var callback = null;
                if(args.length > 0) {
                    if(typeof(args[args.length - 1]) === typeof(function(){})) {
                        callback = args.splice(-1, 1)[0];
                    }
                }
                var options = {};
                for(var optIdx = 0; optIdx &lt; command_options.length; optIdx++) {
                    var option = command_options[optIdx];
                    if(optIdx &lt; args.length) {
                        if(args[optIdx] !== null) {
                            if("no-arg" in option &amp;&amp; option["no-arg"]) {
                                if(args[optIdx]) {
                                    options["--" + option.name] = "";
                                }
                            } else if("extra-option" in option &amp;&amp; option["extra-option"]) {
                                Object.keys(args[optIdx]).forEach(function(key) {
                                    if(args[optIdx][key] == null) {
                                        options["--" + key] = "";
                                    } else {
                                        options["--" + key] = args[optIdx][key];
                                    }
                                });
                            } else {
                                options["--" + option.name] = args[optIdx];
                            }
                        }
                    } else if(option.required) {
                        callbackError("ERROR aws." + service_name + "." + function_name + ":"
                            + option.name + "is required");
                        return;
                    }
                }
                awscli.exec(service_name, command_name, options, callback);
            };}(service_def.commands[command_name].options));
        });
        awscli[service_name.toLowerCase()] = service;
        return service;
    }

    /**
     * THIS METHOD MAY NOT BE USED FROM ANY CODES.
     * Convert an object to string for the command line option value
     *
     * @param {object} obj object to stringify.
     * @returns {string} A string that double quotations are escaped.
     */
    awscli.jsonAsQuotedString = function(obj) {
        return '"' + JSON.stringify(obj).replace(/"/g, '\\"') + '"';
    };

}());
module.exports = awscli;
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.3</a> on Fri Nov 01 2019 21:07:59 GMT+0900 (GMT+09:00) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
